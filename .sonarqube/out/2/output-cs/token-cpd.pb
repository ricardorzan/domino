юб
DC:\Users\ricar\Documents\GitHub\domino\DominoServer\DominoService.cs
	namespace 	
DominoServer
 
{ 
[ 
ServiceBehavior 
( 
ConcurrencyMode $
=% &
ConcurrencyMode' 6
.6 7
Single7 =
,= >
InstanceContextMode? R
=S T
InstanceContextModeU h
.h i
Singlei o
)o p
]p q
public 

partial 
class 
DominoService &
:' (
ILoginService) 6
,6 7
IMenuService8 D
,D E
IChatServiceF R
,R S
ILobbyServiceT a
,a b
IGameServicec o
{ 
readonly 

Dictionary 
< 
int 
,  

Dictionary! +
<+ ,
IGameClient, 7
,7 8
string9 ?
>? @
>@ A
_currentGamesB O
=P Q
newR U

DictionaryV `
<` a
inta d
,d e

Dictionaryf p
<p q
IGameClientq |
,| }
string	~ Д
>
Д Е
>
Е Ж
(
Ж З
)
З И
;
И Й
readonly 

Dictionary 
< 
int 
,  
string! '
[' (
]( )
>) *
	_dominoes+ 4
=5 6
new7 :

Dictionary; E
<E F
intF I
,I J
stringK Q
[Q R
]R S
>S T
(T U
)U V
;V W
public 
void 
JoinCurrentGame #
(# $
int$ '
idGame( .
,. /
string0 6
username7 ?
)? @
{ 	
var 

connection 
= 
OperationContext -
.- .
Current. 5
.5 6
GetCallbackChannel6 H
<H I
IGameClientI T
>T U
(U V
)V W
;W X
if 
( 
! 
_currentGames 
. 
TryGetValue *
(* +
idGame+ 1
,1 2
out3 6

Dictionary7 A
<A B
IGameClientB M
,M N
stringO U
>U V
_membersW _
)_ `
)` a
return 
; 
int 

nextMember 
= 
$num 
; 
string 
[ 
] 
members 
= 
new "
string# )
[) *
_members* 2
.2 3
Count3 8
]8 9
;9 :
foreach 
( 
var 
other 
in !
_members" *
)* +
{ 
if 
( 
other 
. 
Key 
==  

connection! +
)+ ,
{ 

nextMember   
++    
;    !
continue!! 
;!! 
}"" 
members## 
[## 

nextMember## "
]##" #
=##$ %
other##& +
.##+ ,
Value##, 1
;##1 2

nextMember$$ 
++$$ 
;$$ 
other%% 
.%% 
Key%% 
.%% 
ReciveNewMember%% )
(%%) *
username%%* 2
)%%2 3
;%%3 4
}&& 
('' 
('' 

Dictionary'' 
<'' 
IGameClient'' $
,''$ %
string''& ,
>'', -
)''- .
_currentGames''. ;
[''; <
idGame''< B
]''B C
)''C D
.''D E
Add''E H
(''H I

connection''I S
,''S T
username''U ]
)''] ^
;''^ _
try(( 
{)) 

connection** 
.** 
ReciveMembersInGame** .
(**. /
members**/ 6
)**6 7
;**7 8
}++ 
catch,, 
(,, 
	Exception,, 
ex,, 
),,  
{-- 
throw.. 
new.. 
FaultException.. (
(..( )
ex..) +
...+ ,
Message.., 3
)..3 4
;..4 5
}// 
}00 	
public22 
void22 
GetFirstSevenTiles22 &
(22& '
int22' *
idGame22+ 1
)221 2
{33 	
var44 

connection44 
=44 
OperationContext44 -
.44- .
Current44. 5
.445 6
GetCallbackChannel446 H
<44H I
IGameClient44I T
>44T U
(44U V
)44V W
;44W X
string66 
[66 
]66 
dominoesPerPlayer66 &
=66' (
new66) ,
string66- 3
[663 4
$num664 6
]666 7
;667 8
if77 
(77 
!77 
	_dominoes77 
.77 
TryGetValue77 &
(77& '
idGame77' -
,77- .
out77/ 2
string773 9
[779 :
]77: ;
dominoesInGame77< J
)77J K
)77K L
return88 
;88 
Array:: 
.:: 
Copy:: 
(:: 
dominoesInGame:: %
,::% &
$num::' (
,::( )
dominoesPerPlayer::* ;
,::; <
$num::= >
,::> ?
$num::@ A
)::A B
;::B C
var<< 
myList<< 
=<< 
dominoesInGame<< '
.<<' (
ToList<<( .
(<<. /
)<</ 0
;<<0 1
myList== 
.== 
RemoveRange== 
(== 
$num==  
,==  !
$num==" #
)==# $
;==$ %
dominoesInGame>> 
=>> 
myList>> #
.>># $
ToArray>>$ +
(>>+ ,
)>>, -
;>>- .
Shuffle@@ 
(@@ 
dominoesInGame@@ "
)@@" #
;@@# $
	_dominoesBB 
.BB 
RemoveBB 
(BB 
idGameBB #
)BB# $
;BB$ %
	_dominoesCC 
.CC 
AddCC 
(CC 
idGameCC  
,CC  !
dominoesInGameCC" 0
)CC0 1
;CC1 2
tryEE 
{FF 

connectionGG 
.GG 
GetDominoesGG &
(GG& '
dominoesPerPlayerGG' 8
)GG8 9
;GG9 :
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
throwKK 
newKK 
FaultExceptionKK (
(KK( )
exKK) +
.KK+ ,
MessageKK, 3
)KK3 4
;KK4 5
}LL 
}MM 	
publicOO 
voidOO 
GetPlayersNameOO "
(OO" #
intOO# &
idGameOO' -
)OO- .
{PP 	
varQQ 

connectionQQ 
=QQ 
OperationContextQQ -
.QQ- .
CurrentQQ. 5
.QQ5 6
GetCallbackChannelQQ6 H
<QQH I
IGameClientQQI T
>QQT U
(QQU V
)QQV W
;QQW X
ifSS 
(SS 
!SS 
_currentGamesSS 
.SS 
TryGetValueSS *
(SS* +
idGameSS+ 1
,SS1 2
outSS3 6

DictionarySS7 A
<SSA B
IGameClientSSB M
,SSM N
stringSSO U
>SSU V
_membersSSW _
)SS_ `
)SS` a
returnTT 
;TT 
intVV 

nextMemberVV 
=VV 
$numVV 
;VV 
stringWW 
[WW 
]WW 
membersWW 
=WW 
newWW "
stringWW# )
[WW) *
_membersWW* 2
.WW2 3
CountWW3 8
-WW9 :
$numWW; <
]WW< =
;WW= >
foreachXX 
(XX 
varXX 
otherXX 
inXX !
_membersXX" *
)XX* +
{YY 
ifZZ 
(ZZ 
otherZZ 
.ZZ 
KeyZZ 
==ZZ  

connectionZZ! +
)ZZ+ ,
continue[[ 
;[[ 
members\\ 
[\\ 

nextMember\\ "
]\\" #
=\\$ %
other\\& +
.\\+ ,
Value\\, 1
;\\1 2

nextMember]] 
++]] 
;]] 
}^^ 
try__ 
{`` 

connectionaa 
.aa 
ReciveMembersInGameaa .
(aa. /
membersaa/ 6
)aa6 7
;aa7 8
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
throwee 
newee 
FaultExceptionee (
(ee( )
exee) +
.ee+ ,
Messageee, 3
)ee3 4
;ee4 5
}ff 
}gg 	
publicii 
voidii 
GetHighestTileii "
(ii" #
intii# &
idGameii' -
,ii- .
stringii/ 5
hostHighestTileii6 E
)iiE F
{jj 	
varkk 

connectionkk 
=kk 
OperationContextkk -
.kk- .
Currentkk. 5
.kk5 6
GetCallbackChannelkk6 H
<kkH I
IGameClientkkI T
>kkT U
(kkU V
)kkV W
;kkW X
ifll 
(ll 
!ll 
_currentGamesll 
.ll 
TryGetValuell *
(ll* +
idGamell+ 1
,ll1 2
outll3 6

Dictionaryll7 A
<llA B
IGameClientllB M
,llM N
stringllO U
>llU V
_membersllW _
)ll_ `
)ll` a
returnmm 
;mm 
stringnn 
highestTilenn 
=nn  
nullnn! %
;nn% &
stringoo 
[oo 
]oo 
highestOfEachPlayeroo (
=oo) *
newoo+ .
stringoo/ 5
[oo5 6
$numoo6 7
]oo7 8
;oo8 9
intpp 
countpp 
=pp 
$numpp 
;pp 
intqq 
whoIsGonnaStartqq 
=qq  !
$numqq" #
;qq# $
foreachrr 
(rr 
varrr 
otherrr 
inrr !
_membersrr" *
.rr* +
Keysrr+ /
)rr/ 0
{ss 
iftt 
(tt 
othertt 
==tt 

connectiontt '
)tt' (
{uu 
highestOfEachPlayervv '
[vv' (
countvv( -
]vv- .
=vv/ 0
hostHighestTilevv1 @
;vv@ A
countww 
++ww 
;ww 
continuexx 
;xx 
}yy 
highestOfEachPlayerzz #
[zz# $
countzz$ )
]zz) *
=zz+ ,
otherzz- 2
.zz2 3
SendHighestTilezz3 B
(zzB C
)zzC D
;zzD E
count{{ 
++{{ 
;{{ 
}|| 
for}} 
(}} 
int}} 
i}} 
=}} 
$num}} 
;}} 
i}} 
<}} 
_members}}  (
.}}( )
Count}}) .
;}}. /
i}}0 1
++}}1 3
)}}3 4
{~~ 
if 
( 
highestTile 
==  "
null# '
)' (
{
АА 
highestTile
ББ 
=
ББ  !!
highestOfEachPlayer
ББ" 5
[
ББ5 6
i
ББ6 7
]
ББ7 8
;
ББ8 9
whoIsGonnaStart
ВВ #
=
ВВ$ %
i
ВВ& '
;
ВВ' (
}
ГГ 
else
ДД 
{
ЕЕ 
int
ЖЖ 
highestNumberOne
ЖЖ (
=
ЖЖ) *
int
ЖЖ+ .
.
ЖЖ. /
Parse
ЖЖ/ 4
(
ЖЖ4 5
highestTile
ЖЖ5 @
.
ЖЖ@ A
	Substring
ЖЖA J
(
ЖЖJ K
$num
ЖЖK L
,
ЖЖL M
$num
ЖЖN O
)
ЖЖO P
)
ЖЖP Q
;
ЖЖQ R
int
ЗЗ 
highestNumberTwo
ЗЗ (
=
ЗЗ) *
int
ЗЗ+ .
.
ЗЗ. /
Parse
ЗЗ/ 4
(
ЗЗ4 5
highestTile
ЗЗ5 @
.
ЗЗ@ A
	Substring
ЗЗA J
(
ЗЗJ K
$num
ЗЗK L
,
ЗЗL M
$num
ЗЗN O
)
ЗЗO P
)
ЗЗP Q
;
ЗЗQ R
bool
ИИ 
highestIsMule
ИИ &
=
ИИ' (
highestNumberOne
ИИ) 9
==
ИИ: <
highestNumberTwo
ИИ= M
;
ИИM N
int
КК 
	numberOne
КК !
=
КК" #
int
КК$ '
.
КК' (
Parse
КК( -
(
КК- .!
highestOfEachPlayer
КК. A
[
ККA B
i
ККB C
]
ККC D
.
ККD E
	Substring
ККE N
(
ККN O
$num
ККO P
,
ККP Q
$num
ККR S
)
ККS T
)
ККT U
;
ККU V
int
ЛЛ 
	numberTwo
ЛЛ !
=
ЛЛ" #
int
ЛЛ$ '
.
ЛЛ' (
Parse
ЛЛ( -
(
ЛЛ- .!
highestOfEachPlayer
ЛЛ. A
[
ЛЛA B
i
ЛЛB C
]
ЛЛC D
.
ЛЛD E
	Substring
ЛЛE N
(
ЛЛN O
$num
ЛЛO P
,
ЛЛP Q
$num
ЛЛR S
)
ЛЛS T
)
ЛЛT U
;
ЛЛU V
bool
ММ 
isMule
ММ 
=
ММ  !
	numberOne
ММ" +
==
ММ, .
	numberTwo
ММ/ 8
;
ММ8 9
if
ОО 
(
ОО 
highestIsMule
ОО %
)
ОО% &
{
ПП 
if
РР 
(
РР 
isMule
РР "
)
РР" #
{
СС 
if
ТТ 
(
ТТ  
	numberOne
ТТ  )
>
ТТ* +
highestNumberOne
ТТ, <
)
ТТ< =
{
УУ 
highestTile
ФФ  +
=
ФФ, -!
highestOfEachPlayer
ФФ. A
[
ФФA B
i
ФФB C
]
ФФC D
;
ФФD E
whoIsGonnaStart
ХХ  /
=
ХХ0 1
i
ХХ2 3
;
ХХ3 4
}
ЦЦ 
}
ЧЧ 
}
ШШ 
else
ЩЩ 
{
ЪЪ 
if
ЫЫ 
(
ЫЫ 
isMule
ЫЫ "
)
ЫЫ" #
{
ЬЬ 
highestTile
ЭЭ '
=
ЭЭ( )!
highestOfEachPlayer
ЭЭ* =
[
ЭЭ= >
i
ЭЭ> ?
]
ЭЭ? @
;
ЭЭ@ A
whoIsGonnaStart
ЮЮ +
=
ЮЮ, -
i
ЮЮ. /
;
ЮЮ/ 0
}
ЯЯ 
else
†† 
{
°° 
int
ҐҐ 
weight
ҐҐ  &
=
ҐҐ' (
	numberOne
ҐҐ) 2
+
ҐҐ3 4
	numberTwo
ҐҐ5 >
;
ҐҐ> ?
int
££ 
highestWeight
££  -
=
££. /
highestNumberOne
££0 @
+
££A B
highestNumberTwo
££C S
;
££S T
if
§§ 
(
§§  
weight
§§  &
>
§§' (
highestWeight
§§) 6
)
§§6 7
{
•• 
highestTile
¶¶  +
=
¶¶, -!
highestOfEachPlayer
¶¶. A
[
¶¶A B
i
¶¶B C
]
¶¶C D
;
¶¶D E
whoIsGonnaStart
ІІ  /
=
ІІ0 1
i
ІІ2 3
;
ІІ3 4
}
®® 
}
©© 
}
™™ 
}
ЂЂ 
}
ђђ 
count
≠≠ 
=
≠≠ 
$num
≠≠ 
;
≠≠ 
foreach
ЃЃ 
(
ЃЃ 
var
ЃЃ 
other
ЃЃ 
in
ЃЃ !
_members
ЃЃ" *
.
ЃЃ* +
Keys
ЃЃ+ /
)
ЃЃ/ 0
{
ѓѓ 
if
∞∞ 
(
∞∞ 
count
∞∞ 
==
∞∞ 
whoIsGonnaStart
∞∞ ,
)
∞∞, -
{
±± 
other
≤≤ 
.
≤≤ 

IsYourTurn
≤≤ $
(
≤≤$ %
isFirstTurn
≤≤% 0
:
≤≤0 1
true
≤≤2 6
)
≤≤6 7
;
≤≤7 8
break
≥≥ 
;
≥≥ 
}
іі 
count
µµ 
++
µµ 
;
µµ 
}
ґґ 
}
ЈЈ 	
public
єє 
void
єє 
PutATile
єє 
(
єє 
int
єє  
idGame
єє! '
,
єє' (
string
єє) /
tile
єє0 4
)
єє4 5
{
ЇЇ 	
var
її 

connection
її 
=
її 
OperationContext
її -
.
її- .
Current
її. 5
.
її5 6 
GetCallbackChannel
її6 H
<
їїH I
IGameClient
їїI T
>
їїT U
(
їїU V
)
їїV W
;
їїW X
if
ЉЉ 
(
ЉЉ 
!
ЉЉ 
_currentGames
ЉЉ 
.
ЉЉ 
TryGetValue
ЉЉ *
(
ЉЉ* +
idGame
ЉЉ+ 1
,
ЉЉ1 2
out
ЉЉ3 6

Dictionary
ЉЉ7 A
<
ЉЉA B
IGameClient
ЉЉB M
,
ЉЉM N
string
ЉЉO U
>
ЉЉU V
_members
ЉЉW _
)
ЉЉ_ `
)
ЉЉ` a
return
љљ 
;
љљ 
if
ЊЊ 
(
ЊЊ 
!
ЊЊ 
_members
ЊЊ 
.
ЊЊ 
TryGetValue
ЊЊ %
(
ЊЊ% &

connection
ЊЊ& 0
,
ЊЊ0 1
out
ЊЊ2 5
string
ЊЊ6 <
whoPutTheTile
ЊЊ= J
)
ЊЊJ K
)
ЊЊK L
return
њњ 
;
њњ 
foreach
јј 
(
јј 
var
јј 
other
јј 
in
јј !
_members
јј" *
.
јј* +
Keys
јј+ /
)
јј/ 0
{
ЅЅ 
if
√√ 
(
√√ 
other
√√ 
==
√√ 

connection
√√ '
)
√√' (
continue
ƒƒ 
;
ƒƒ 
other
≈≈ 
.
≈≈ 
SomeonePutATile
≈≈ %
(
≈≈% &
whoPutTheTile
≈≈& 3
,
≈≈3 4
tile
≈≈5 9
)
≈≈9 :
;
≈≈: ;
}
∆∆ 
}
«« 	
public
…… 
void
…… 
PassTurn
…… 
(
…… 
int
……  
idGame
……! '
)
……' (
{
   	
var
ЋЋ 

connection
ЋЋ 
=
ЋЋ 
OperationContext
ЋЋ -
.
ЋЋ- .
Current
ЋЋ. 5
.
ЋЋ5 6 
GetCallbackChannel
ЋЋ6 H
<
ЋЋH I
IGameClient
ЋЋI T
>
ЋЋT U
(
ЋЋU V
)
ЋЋV W
;
ЋЋW X
if
ћћ 
(
ћћ 
!
ћћ 
_currentGames
ћћ 
.
ћћ 
TryGetValue
ћћ *
(
ћћ* +
idGame
ћћ+ 1
,
ћћ1 2
out
ћћ3 6

Dictionary
ћћ7 A
<
ћћA B
IGameClient
ћћB M
,
ћћM N
string
ћћO U
>
ћћU V
_members
ћћW _
)
ћћ_ `
)
ћћ` a
return
ЌЌ 
;
ЌЌ 
bool
ќќ 
nextTurn
ќќ 
=
ќќ 
false
ќќ !
;
ќќ! "
foreach
ѕѕ 
(
ѕѕ 
var
ѕѕ 
other
ѕѕ 
in
ѕѕ !
_members
ѕѕ" *
.
ѕѕ* +
Keys
ѕѕ+ /
)
ѕѕ/ 0
{
–– 
if
—— 
(
—— 
other
—— 
==
—— 

connection
—— '
)
——' (
{
““ 
nextTurn
”” 
=
”” 
true
”” #
;
””# $
continue
‘‘ 
;
‘‘ 
}
’’ 
if
÷÷ 
(
÷÷ 
nextTurn
÷÷ 
)
÷÷ 
{
„„ 
other
ЎЎ 
.
ЎЎ 

IsYourTurn
ЎЎ $
(
ЎЎ$ %
isFirstTurn
ЎЎ% 0
:
ЎЎ0 1
false
ЎЎ2 7
)
ЎЎ7 8
;
ЎЎ8 9
nextTurn
ўў 
=
ўў 
false
ўў $
;
ўў$ %
}
ЏЏ 
}
џџ 
if
№№ 
(
№№ 
nextTurn
№№ 
)
№№ 
_members
ЁЁ 
.
ЁЁ 
First
ЁЁ 
(
ЁЁ 
)
ЁЁ  
.
ЁЁ  !
Key
ЁЁ! $
.
ЁЁ$ %

IsYourTurn
ЁЁ% /
(
ЁЁ/ 0
isFirstTurn
ЁЁ0 ;
:
ЁЁ; <
false
ЁЁ= B
)
ЁЁB C
;
ЁЁC D
}
ёё 	
public
аа 
void
аа 
TakeFromTheBank
аа #
(
аа# $
int
аа$ '
idGame
аа( .
)
аа. /
{
бб 	
var
вв 

connection
вв 
=
вв 
OperationContext
вв -
.
вв- .
Current
вв. 5
.
вв5 6 
GetCallbackChannel
вв6 H
<
ввH I
IGameClient
ввI T
>
ввT U
(
ввU V
)
ввV W
;
ввW X
if
гг 
(
гг 
!
гг 
	_dominoes
гг 
.
гг 
TryGetValue
гг &
(
гг& '
idGame
гг' -
,
гг- .
out
гг/ 2
string
гг3 9
[
гг9 :
]
гг: ;
dominoesInGame
гг< J
)
ггJ K
)
ггK L
return
дд 
;
дд 
string
жж 
newTile
жж 
=
жж 
dominoesInGame
жж +
[
жж+ ,
$num
жж, -
]
жж- .
;
жж. /
var
ии 
myList
ии 
=
ии 
dominoesInGame
ии '
.
ии' (
ToList
ии( .
(
ии. /
)
ии/ 0
;
ии0 1
myList
йй 
.
йй 
RemoveRange
йй 
(
йй 
$num
йй  
,
йй  !
$num
йй" #
)
йй# $
;
йй$ %
dominoesInGame
кк 
=
кк 
myList
кк #
.
кк# $
ToArray
кк$ +
(
кк+ ,
)
кк, -
;
кк- .
Shuffle
мм 
(
мм 
dominoesInGame
мм "
)
мм" #
;
мм# $
	_dominoes
оо 
.
оо 
Remove
оо 
(
оо 
idGame
оо #
)
оо# $
;
оо$ %
	_dominoes
пп 
.
пп 
Add
пп 
(
пп 
idGame
пп  
,
пп  !
dominoesInGame
пп" 0
)
пп0 1
;
пп1 2
if
сс 
(
сс 
!
сс 
_currentGames
сс 
.
сс 
TryGetValue
сс *
(
сс* +
idGame
сс+ 1
,
сс1 2
out
сс3 6

Dictionary
сс7 A
<
ссA B
IGameClient
ссB M
,
ссM N
string
ссO U
>
ссU V
_members
ссW _
)
сс_ `
)
сс` a
return
тт 
;
тт 
if
уу 
(
уу 
!
уу 
_members
уу 
.
уу 
TryGetValue
уу %
(
уу% &

connection
уу& 0
,
уу0 1
out
уу2 5
string
уу6 <
whoTookTheTile
уу= K
)
ууK L
)
ууL M
return
фф 
;
фф 
foreach
хх 
(
хх 
var
хх 
other
хх 
in
хх !
_members
хх" *
)
хх* +
{
цц 
if
чч 
(
чч 
other
чч 
.
чч 
Key
чч 
==
чч  

connection
чч! +
)
чч+ ,
continue
шш 
;
шш 
other
щщ 
.
щщ 
Key
щщ 
.
щщ 
SomeoneTookATile
щщ *
(
щщ* +
whoTookTheTile
щщ+ 9
)
щщ9 :
;
щщ: ;
}
ъъ 
try
ьь 
{
ээ 

connection
юю 
.
юю 

GetTheTile
юю %
(
юю% &
newTile
юю& -
)
юю- .
;
юю. /
}
€€ 
catch
АА 
(
АА &
IndexOutOfRangeException
АА +
ex
АА, .
)
АА. /
{
ББ 
throw
ВВ 
new
ВВ 
FaultException
ВВ (
(
ВВ( )
ex
ВВ) +
.
ВВ+ ,
Message
ВВ, 3
)
ВВ3 4
;
ВВ4 5
}
ГГ 
}
ДД 	
public
ЖЖ 
void
ЖЖ 
Win
ЖЖ 
(
ЖЖ 
int
ЖЖ 
idGame
ЖЖ "
)
ЖЖ" #
{
ЗЗ 	
var
ИИ 

connection
ИИ 
=
ИИ 
OperationContext
ИИ -
.
ИИ- .
Current
ИИ. 5
.
ИИ5 6 
GetCallbackChannel
ИИ6 H
<
ИИH I
IGameClient
ИИI T
>
ИИT U
(
ИИU V
)
ИИV W
;
ИИW X
if
ЙЙ 
(
ЙЙ 
!
ЙЙ 
_currentGames
ЙЙ 
.
ЙЙ 
TryGetValue
ЙЙ *
(
ЙЙ* +
idGame
ЙЙ+ 1
,
ЙЙ1 2
out
ЙЙ3 6

Dictionary
ЙЙ7 A
<
ЙЙA B
IGameClient
ЙЙB M
,
ЙЙM N
string
ЙЙO U
>
ЙЙU V
_members
ЙЙW _
)
ЙЙ_ `
)
ЙЙ` a
return
КК 
;
КК 
if
ЛЛ 
(
ЛЛ 
!
ЛЛ 
_members
ЛЛ 
.
ЛЛ 
TryGetValue
ЛЛ %
(
ЛЛ% &

connection
ЛЛ& 0
,
ЛЛ0 1
out
ЛЛ2 5
string
ЛЛ6 <
	theWinner
ЛЛ= F
)
ЛЛF G
)
ЛЛG H
return
ММ 
;
ММ 
foreach
НН 
(
НН 
var
НН 
other
НН 
in
НН !
_members
НН" *
)
НН* +
{
ОО 
if
ПП 
(
ПП 
other
ПП 
.
ПП 
Key
ПП 
==
ПП  

connection
ПП! +
)
ПП+ ,
continue
РР 
;
РР 
other
СС 
.
СС 
Key
СС 
.
СС  
SomeoneWonTheRound
СС ,
(
СС, -
	theWinner
СС- 6
)
СС6 7
;
СС7 8
}
ТТ 
try
ФФ 
{
ХХ 
using
ЦЦ 
(
ЦЦ 
DominoContext
ЦЦ $
context
ЦЦ% ,
=
ЦЦ- .
new
ЦЦ/ 2
DominoContext
ЦЦ3 @
(
ЦЦ@ A
)
ЦЦA B
)
ЦЦB C
{
ЧЧ 
var
ШШ 
round
ШШ 
=
ШШ 
context
ШШ  '
.
ШШ' (
Ronda
ШШ( -
.
ШШ- .
FirstOrDefault
ШШ. <
(
ШШ< =
r
ШШ= >
=>
ШШ? A
r
ШШB C
.
ШШC D
RondaID
ШШD K
==
ШШL N
idGame
ШШO U
)
ШШU V
;
ШШV W
round
ЩЩ 
.
ЩЩ 
Ganador
ЩЩ !
=
ЩЩ" #
	theWinner
ЩЩ$ -
;
ЩЩ- .
var
ЪЪ 
game
ЪЪ 
=
ЪЪ 
round
ЪЪ $
.
ЪЪ$ %
Juego
ЪЪ% *
;
ЪЪ* +
game
ЫЫ 
.
ЫЫ 
Ganador
ЫЫ  
=
ЫЫ! "
	theWinner
ЫЫ# ,
;
ЫЫ, -
context
ЬЬ 
.
ЬЬ 
SaveChanges
ЬЬ '
(
ЬЬ' (
)
ЬЬ( )
;
ЬЬ) *
}
ЭЭ 
}
ЮЮ 
catch
ЯЯ 
(
ЯЯ 
	Exception
ЯЯ 
ex
ЯЯ 
)
ЯЯ  
{
†† 
throw
°° 
new
°° 
	Exception
°° #
(
°°# $
ex
°°$ &
.
°°& '
Message
°°' .
)
°°. /
;
°°/ 0
}
ҐҐ 
}
££ 	
public
•• 
void
•• 
UploadPoints
••  
(
••  !
int
••! $
idGame
••% +
,
••+ ,
int
••- 0
points
••1 7
)
••7 8
{
¶¶ 	
var
ІІ 

connection
ІІ 
=
ІІ 
OperationContext
ІІ -
.
ІІ- .
Current
ІІ. 5
.
ІІ5 6 
GetCallbackChannel
ІІ6 H
<
ІІH I
IGameClient
ІІI T
>
ІІT U
(
ІІU V
)
ІІV W
;
ІІW X
if
®® 
(
®® 
!
®® 
_currentGames
®® 
.
®® 
TryGetValue
®® *
(
®®* +
idGame
®®+ 1
,
®®1 2
out
®®3 6

Dictionary
®®7 A
<
®®A B
IGameClient
®®B M
,
®®M N
string
®®O U
>
®®U V
_members
®®W _
)
®®_ `
)
®®` a
return
©© 
;
©© 
if
™™ 
(
™™ 
!
™™ 
_members
™™ 
.
™™ 
TryGetValue
™™ %
(
™™% &

connection
™™& 0
,
™™0 1
out
™™2 5
string
™™6 <
username
™™= E
)
™™E F
)
™™F G
return
ЂЂ 
;
ЂЂ 
try
ђђ 
{
≠≠ 
using
ЃЃ 
(
ЃЃ 
DominoContext
ЃЃ $
context
ЃЃ% ,
=
ЃЃ- .
new
ЃЃ/ 2
DominoContext
ЃЃ3 @
(
ЃЃ@ A
)
ЃЃA B
)
ЃЃB C
{
ѓѓ 
var
∞∞ 
player
∞∞ 
=
∞∞  
context
∞∞! (
.
∞∞( )
Jugador
∞∞) 0
.
∞∞0 1
FirstOrDefault
∞∞1 ?
(
∞∞? @
p
∞∞@ A
=>
∞∞B D
p
∞∞E F
.
∞∞F G
RondaID
∞∞G N
==
∞∞O Q
idGame
∞∞R X
&&
∞∞Y [
p
∞∞\ ]
.
∞∞] ^
Usuario
∞∞^ e
.
∞∞e f
Nombreusuario
∞∞f s
==
∞∞t v
username
∞∞w 
)∞∞ А
;∞∞А Б
player
±± 
.
±± 
Puntaje
±± "
=
±±# $
points
±±% +
;
±±+ ,
var
≤≤ 
user
≤≤ 
=
≤≤ 
player
≤≤ %
.
≤≤% &
Usuario
≤≤& -
;
≤≤- .
user
≥≥ 
.
≥≥ 
Puntajeacumulado
≥≥ )
=
≥≥* +
user
≥≥, 0
.
≥≥0 1
Puntajeacumulado
≥≥1 A
+
≥≥B C
points
≥≥D J
;
≥≥J K
context
іі 
.
іі 
SaveChanges
іі '
(
іі' (
)
іі( )
;
іі) *
}
µµ 
_members
ґґ 
.
ґґ 
Remove
ґґ 
(
ґґ  

connection
ґґ  *
)
ґґ* +
;
ґґ+ ,
if
ЈЈ 
(
ЈЈ 
_members
ЈЈ 
.
ЈЈ 
Count
ЈЈ "
==
ЈЈ# %
$num
ЈЈ& '
)
ЈЈ' (
{
ЄЄ 
_rooms
єє 
.
єє 
Remove
єє !
(
єє! "
idGame
єє" (
)
єє( )
;
єє) *
_currentGames
ЇЇ !
.
ЇЇ! "
Remove
ЇЇ" (
(
ЇЇ( )
idGame
ЇЇ) /
)
ЇЇ/ 0
;
ЇЇ0 1
	_dominoes
її 
.
її 
Remove
її $
(
її$ %
idGame
її% +
)
її+ ,
;
її, -
}
ЉЉ 
}
љљ 
catch
ЊЊ 
(
ЊЊ 
	Exception
ЊЊ 
ex
ЊЊ 
)
ЊЊ  
{
њњ 
throw
јј 
new
јј 
	Exception
јј #
(
јј# $
ex
јј$ &
.
јј& '
Message
јј' .
)
јј. /
;
јј/ 0
}
ЅЅ 
}
¬¬ 	
readonly
ƒƒ 

Dictionary
ƒƒ 
<
ƒƒ 
ILobbyClient
ƒƒ (
,
ƒƒ( )
string
ƒƒ* 0
>
ƒƒ0 1
_lobbies
ƒƒ2 :
=
ƒƒ; <
new
ƒƒ= @

Dictionary
ƒƒA K
<
ƒƒK L
ILobbyClient
ƒƒL X
,
ƒƒX Y
string
ƒƒZ `
>
ƒƒ` a
(
ƒƒa b
)
ƒƒb c
;
ƒƒc d
public
≈≈ 
void
≈≈ 
	JoinLobby
≈≈ 
(
≈≈ 
string
≈≈ $
username
≈≈% -
)
≈≈- .
{
∆∆ 	
var
«« 

connection
«« 
=
«« 
OperationContext
«« -
.
««- .
Current
««. 5
.
««5 6 
GetCallbackChannel
««6 H
<
««H I
ILobbyClient
««I U
>
««U V
(
««V W
)
««W X
;
««X Y
_lobbies
»» 
[
»» 

connection
»» 
]
»»  
=
»»! "
username
»»# +
;
»»+ ,
}
…… 	
public
ЋЋ 
void
ЋЋ 
GetGames
ЋЋ 
(
ЋЋ 
)
ЋЋ 
{
ћћ 	
var
ЌЌ 

connection
ЌЌ 
=
ЌЌ 
OperationContext
ЌЌ -
.
ЌЌ- .
Current
ЌЌ. 5
.
ЌЌ5 6 
GetCallbackChannel
ЌЌ6 H
<
ЌЌH I
ILobbyClient
ЌЌI U
>
ЌЌU V
(
ЌЌV W
)
ЌЌW X
;
ЌЌX Y
foreach
ќќ 
(
ќќ 
var
ќќ 
other
ќќ 
in
ќќ !
_games
ќќ" (
.
ќќ( )
Keys
ќќ) -
)
ќќ- .
{
ѕѕ 

connection
–– 
.
–– 

ReciveGame
–– %
(
––% &
other
––& +
)
––+ ,
;
––, -
}
—— 
}
““ 	
readonly
‘‘ 

Dictionary
‘‘ 
<
‘‘ 
string
‘‘ "
,
‘‘" #

Dictionary
‘‘$ .
<
‘‘. /
ILobbyClient
‘‘/ ;
,
‘‘; <
string
‘‘= C
>
‘‘C D
>
‘‘D E
_games
‘‘F L
=
‘‘M N
new
‘‘O R

Dictionary
‘‘S ]
<
‘‘] ^
string
‘‘^ d
,
‘‘d e

Dictionary
‘‘f p
<
‘‘p q
ILobbyClient
‘‘q }
,
‘‘} ~
string‘‘ Е
>‘‘Е Ж
>‘‘Ж З
(‘‘З И
)‘‘И Й
;‘‘Й К
public
’’ 
void
’’ 

CreateGame
’’ 
(
’’ 
string
’’ %
gameName
’’& .
)
’’. /
{
÷÷ 	
var
„„ 

connection
„„ 
=
„„ 
OperationContext
„„ -
.
„„- .
Current
„„. 5
.
„„5 6 
GetCallbackChannel
„„6 H
<
„„H I
ILobbyClient
„„I U
>
„„U V
(
„„V W
)
„„W X
;
„„X Y

Dictionary
ЎЎ 
<
ЎЎ 
ILobbyClient
ЎЎ #
,
ЎЎ# $
string
ЎЎ% +
>
ЎЎ+ ,
_members
ЎЎ- 5
=
ЎЎ6 7
new
ЎЎ8 ;

Dictionary
ЎЎ< F
<
ЎЎF G
ILobbyClient
ЎЎG S
,
ЎЎS T
string
ЎЎU [
>
ЎЎ[ \
(
ЎЎ\ ]
)
ЎЎ] ^
;
ЎЎ^ _
_games
ўў 
.
ўў 
Add
ўў 
(
ўў 
gameName
ўў 
,
ўў  
_members
ўў! )
)
ўў) *
;
ўў* +
if
џџ 
(
џџ 
!
џџ 
_lobbies
џџ 
.
џџ 
TryGetValue
џџ %
(
џџ% &

connection
џџ& 0
,
џџ0 1
out
џџ2 5
string
џџ6 <
host
џџ= A
)
џџA B
)
џџB C
return
№№ 
;
№№ 
(
ёё 
(
ёё 

Dictionary
ёё 
<
ёё 
ILobbyClient
ёё %
,
ёё% &
string
ёё' -
>
ёё- .
)
ёё. /
_games
ёё/ 5
[
ёё5 6
gameName
ёё6 >
]
ёё> ?
)
ёё? @
.
ёё@ A
Add
ёёA D
(
ёёD E

connection
ёёE O
,
ёёO P
host
ёёQ U
)
ёёU V
;
ёёV W
foreach
аа 
(
аа 
var
аа 
other
аа 
in
аа !
_lobbies
аа" *
.
аа* +
Keys
аа+ /
)
аа/ 0
{
бб 
if
вв 
(
вв 
other
вв 
==
вв 

connection
вв '
)
вв' (
continue
гг 
;
гг 
other
дд 
.
дд 

ReciveGame
дд  
(
дд  !
gameName
дд! )
)
дд) *
;
дд* +
}
ее 
}
жж 	
public
ии 
void
ии 
JoinGame
ии 
(
ии 
string
ии #
gameName
ии$ ,
)
ии, -
{
йй 	
var
кк 

connection
кк 
=
кк 
OperationContext
кк -
.
кк- .
Current
кк. 5
.
кк5 6 
GetCallbackChannel
кк6 H
<
ккH I
ILobbyClient
ккI U
>
ккU V
(
ккV W
)
ккW X
;
ккX Y
if
лл 
(
лл 
!
лл 
_lobbies
лл 
.
лл 
TryGetValue
лл %
(
лл% &

connection
лл& 0
,
лл0 1
out
лл2 5
string
лл6 <
	newMember
лл= F
)
ллF G
)
ллG H
return
мм 
;
мм 
if
оо 
(
оо 
!
оо 
_games
оо 
.
оо 
TryGetValue
оо #
(
оо# $
gameName
оо$ ,
,
оо, -
out
оо. 1

Dictionary
оо2 <
<
оо< =
ILobbyClient
оо= I
,
ооI J
string
ооK Q
>
ооQ R
_members
ооS [
)
оо[ \
)
оо\ ]
return
пп 
;
пп 
int
сс 
numberOfPlayers
сс 
=
сс  !
$num
сс" #
;
сс# $
bool
тт 
canEnter
тт 
=
тт 
false
тт !
;
тт! "
foreach
фф 
(
фф 
var
фф 
other
фф 
in
фф !
_members
фф" *
.
фф* +
Keys
фф+ /
)
фф/ 0
{
хх 
other
цц 
.
цц !
SendNumberOfPlayers
цц )
(
цц) *
out
цц* -
numberOfPlayers
цц. =
)
цц= >
;
цц> ?
if
чч 
(
чч 
numberOfPlayers
чч #
!=
чч$ &
$num
чч' (
)
чч( )
break
шш 
;
шш 
}
щщ 
if
ыы 
(
ыы 
numberOfPlayers
ыы 
>
ыы  !
_members
ыы" *
.
ыы* +
Count
ыы+ 0
)
ыы0 1
canEnter
ьь 
=
ьь 
true
ьь 
;
ьь  
if
юю 
(
юю 
canEnter
юю 
)
юю 
{
€€ 
int
АА 

nextMember
АА 
=
АА  
$num
АА! "
;
АА" #
string
ББ 
[
ББ 
]
ББ 
members
ББ  
=
ББ! "
new
ББ# &
string
ББ' -
[
ББ- .
_members
ББ. 6
.
ББ6 7
Count
ББ7 <
]
ББ< =
;
ББ= >
foreach
ВВ 
(
ВВ 
var
ВВ 
other
ВВ "
in
ВВ# %
_members
ВВ& .
.
ВВ. /
Keys
ВВ/ 3
)
ВВ3 4
{
ГГ 
if
ДД 
(
ДД 
other
ДД 
==
ДД  

connection
ДД! +
)
ДД+ ,
continue
ЕЕ  
;
ЕЕ  !
members
ЖЖ 
[
ЖЖ 

nextMember
ЖЖ &
]
ЖЖ& '
=
ЖЖ( )
other
ЖЖ* /
.
ЖЖ/ 0
SendUsername
ЖЖ0 <
(
ЖЖ< =
)
ЖЖ= >
;
ЖЖ> ?

nextMember
ЗЗ 
++
ЗЗ  
;
ЗЗ  !
other
ИИ 
.
ИИ 
ReciveMember
ИИ &
(
ИИ& '
	newMember
ИИ' 0
)
ИИ0 1
;
ИИ1 2
}
ЙЙ 
(
КК 
(
КК 

Dictionary
КК 
<
КК 
ILobbyClient
КК )
,
КК) *
string
КК+ 1
>
КК1 2
)
КК2 3
_games
КК3 9
[
КК9 :
gameName
КК: B
]
ККB C
)
ККC D
.
ККD E
Add
ККE H
(
ККH I

connection
ККI S
,
ККS T
	newMember
ККU ^
)
КК^ _
;
КК_ `

connection
ЛЛ 
.
ЛЛ 
ReciveMembers
ЛЛ (
(
ЛЛ( )
members
ЛЛ) 0
)
ЛЛ0 1
;
ЛЛ1 2
}
ММ 
else
НН 

connection
ОО 
.
ОО 
GameFull
ОО #
(
ОО# $
)
ОО$ %
;
ОО% &
}
ПП 	
public
СС 
void
СС 
	BreakGame
СС 
(
СС 
string
СС $
gameName
СС% -
)
СС- .
{
ТТ 	
var
УУ 

connection
УУ 
=
УУ 
OperationContext
УУ -
.
УУ- .
Current
УУ. 5
.
УУ5 6 
GetCallbackChannel
УУ6 H
<
УУH I
ILobbyClient
УУI U
>
УУU V
(
УУV W
)
УУW X
;
УУX Y
if
ХХ 
(
ХХ 
!
ХХ 
_games
ХХ 
.
ХХ 
TryGetValue
ХХ #
(
ХХ# $
gameName
ХХ$ ,
,
ХХ, -
out
ХХ. 1

Dictionary
ХХ2 <
<
ХХ< =
ILobbyClient
ХХ= I
,
ХХI J
string
ХХK Q
>
ХХQ R
_members
ХХS [
)
ХХ[ \
)
ХХ\ ]
return
ЦЦ 
;
ЦЦ 
foreach
ШШ 
(
ШШ 
var
ШШ 
other
ШШ 
in
ШШ !
_members
ШШ" *
.
ШШ* +
Keys
ШШ+ /
)
ШШ/ 0
{
ЩЩ 
if
ЪЪ 
(
ЪЪ 
other
ЪЪ 
==
ЪЪ 

connection
ЪЪ '
)
ЪЪ' (
continue
ЫЫ 
;
ЫЫ 
bool
ЬЬ 
	kickedOut
ЬЬ 
=
ЬЬ  
false
ЬЬ! &
;
ЬЬ& '
other
ЭЭ 
.
ЭЭ 
	LeaveGame
ЭЭ 
(
ЭЭ  
	kickedOut
ЭЭ  )
)
ЭЭ) *
;
ЭЭ* +
}
ЮЮ 
_games
†† 
.
†† 
Remove
†† 
(
†† 
gameName
†† "
)
††" #
;
††# $
foreach
ҐҐ 
(
ҐҐ 
var
ҐҐ 
other
ҐҐ 
in
ҐҐ !
_lobbies
ҐҐ" *
.
ҐҐ* +
Keys
ҐҐ+ /
)
ҐҐ/ 0
{
££ 
if
§§ 
(
§§ 
other
§§ 
==
§§ 

connection
§§ '
)
§§' (
continue
•• 
;
•• 
other
¶¶ 
.
¶¶ 
UpdateGames
¶¶ !
(
¶¶! "
)
¶¶" #
;
¶¶# $
}
ІІ 
}
®® 	
public
™™ 
void
™™ 
MemberLeftGame
™™ "
(
™™" #
string
™™# )
gameName
™™* 2
)
™™2 3
{
ЂЂ 	
var
ђђ 

connection
ђђ 
=
ђђ 
OperationContext
ђђ -
.
ђђ- .
Current
ђђ. 5
.
ђђ5 6 
GetCallbackChannel
ђђ6 H
<
ђђH I
ILobbyClient
ђђI U
>
ђђU V
(
ђђV W
)
ђђW X
;
ђђX Y
if
≠≠ 
(
≠≠ 
!
≠≠ 
_lobbies
≠≠ 
.
≠≠ 
TryGetValue
≠≠ %
(
≠≠% &

connection
≠≠& 0
,
≠≠0 1
out
≠≠2 5
string
≠≠6 <
memberWhoLeft
≠≠= J
)
≠≠J K
)
≠≠K L
return
ЃЃ 
;
ЃЃ 
(
∞∞ 
(
∞∞ 

Dictionary
∞∞ 
<
∞∞ 
ILobbyClient
∞∞ %
,
∞∞% &
string
∞∞' -
>
∞∞- .
)
∞∞. /
_games
∞∞/ 5
[
∞∞5 6
gameName
∞∞6 >
]
∞∞> ?
)
∞∞? @
.
∞∞@ A
Remove
∞∞A G
(
∞∞G H

connection
∞∞H R
)
∞∞R S
;
∞∞S T
if
≤≤ 
(
≤≤ 
!
≤≤ 
_games
≤≤ 
.
≤≤ 
TryGetValue
≤≤ #
(
≤≤# $
gameName
≤≤$ ,
,
≤≤, -
out
≤≤. 1

Dictionary
≤≤2 <
<
≤≤< =
ILobbyClient
≤≤= I
,
≤≤I J
string
≤≤K Q
>
≤≤Q R
_members
≤≤S [
)
≤≤[ \
)
≤≤\ ]
return
≥≥ 
;
≥≥ 
foreach
µµ 
(
µµ 
var
µµ 
other
µµ 
in
µµ !
_members
µµ" *
.
µµ* +
Keys
µµ+ /
)
µµ/ 0
{
ґґ 
if
ЈЈ 
(
ЈЈ 
other
ЈЈ 
==
ЈЈ 

connection
ЈЈ '
)
ЈЈ' (
continue
ЄЄ 
;
ЄЄ 
other
єє 
.
єє 
SomeoneLeftGame
єє %
(
єє% &
memberWhoLeft
єє& 3
)
єє3 4
;
єє4 5
}
ЇЇ 
}
її 	
public
љљ 
void
љљ 

KickPlayer
љљ 
(
љљ 
string
љљ %
username
љљ& .
,
љљ. /
string
љљ0 6
gameName
љљ7 ?
)
љљ? @
{
ЊЊ 	
var
њњ 

connection
њњ 
=
њњ 
OperationContext
њњ -
.
њњ- .
Current
њњ. 5
.
њњ5 6 
GetCallbackChannel
њњ6 H
<
њњH I
ILobbyClient
њњI U
>
њњU V
(
њњV W
)
њњW X
;
њњX Y
if
јј 
(
јј 
!
јј 
_games
јј 
.
јј 
TryGetValue
јј #
(
јј# $
gameName
јј$ ,
,
јј, -
out
јј. 1

Dictionary
јј2 <
<
јј< =
ILobbyClient
јј= I
,
јјI J
string
јјK Q
>
јјQ R
_members
јјS [
)
јј[ \
)
јј\ ]
return
ЅЅ 
;
ЅЅ 
bool
¬¬ 
	kickedOut
¬¬ 
=
¬¬ 
true
¬¬ !
;
¬¬! "
foreach
√√ 
(
√√ 
var
√√ 
other
√√ 
in
√√ !
_members
√√" *
.
√√* +
Keys
√√+ /
)
√√/ 0
{
ƒƒ 
if
≈≈ 
(
≈≈ 
other
≈≈ 
==
≈≈ 

connection
≈≈ '
)
≈≈' (
continue
∆∆ 
;
∆∆ 
if
«« 
(
«« 
!
«« 
_members
«« 
.
«« 
TryGetValue
«« )
(
««) *
other
««* /
,
««/ 0
out
««1 4
string
««5 ;
member
««< B
)
««B C
)
««C D
return
»» 
;
»» 
if
…… 
(
…… 
member
…… 
==
…… 
username
…… &
)
……& '
{
   
other
ЋЋ 
.
ЋЋ 
	LeaveGame
ЋЋ #
(
ЋЋ# $
	kickedOut
ЋЋ$ -
)
ЋЋ- .
;
ЋЋ. /
break
ћћ 
;
ћћ 
}
ЌЌ 
}
ќќ 
}
ѕѕ 	
public
—— 
void
—— 
	StartGame
—— 
(
—— 
string
—— $
gameName
——% -
)
——- .
{
““ 	
try
”” 
{
‘‘ 
using
’’ 
(
’’ 
DominoContext
’’ $
context
’’% ,
=
’’- .
new
’’/ 2
DominoContext
’’3 @
(
’’@ A
)
’’A B
)
’’B C
{
÷÷ 
if
„„ 
(
„„ 
!
„„ 
_games
„„ 
.
„„  
TryGetValue
„„  +
(
„„+ ,
gameName
„„, 4
,
„„4 5
out
„„6 9

Dictionary
„„: D
<
„„D E
ILobbyClient
„„E Q
,
„„Q R
string
„„S Y
>
„„Y Z
_members
„„[ c
)
„„c d
)
„„d e
return
ЎЎ 
;
ЎЎ 
var
ЏЏ 
game
ЏЏ 
=
ЏЏ 
new
ЏЏ "
Juego
ЏЏ# (
{
џџ "
Condici√≥ndevictoria
№№ +
=
№№, -
$str
№№. :
,
№№: ;
	Duraci√≥n
ЁЁ  
=
ЁЁ! "
null
ЁЁ# '
,
ЁЁ' (
Ganador
ёё 
=
ёё  !
null
ёё" &
,
ёё& '
}
яя 
;
яя 
context
аа 
.
аа 
Juego
аа !
.
аа! "
Add
аа" %
(
аа% &
game
аа& *
)
аа* +
;
аа+ ,
context
бб 
.
бб 
SaveChanges
бб '
(
бб' (
)
бб( )
;
бб) *
var
дд 
round
дд 
=
дд 
new
дд  #
Ronda
дд$ )
{
ее 
Ganador
жж 
=
жж  !
null
жж" &
,
жж& '
Valorfichaderecha
зз )
=
зз* +
null
зз, 0
,
зз0 1!
Valorfichaizquierda
ии +
=
ии, -
null
ии. 2
,
ии2 3
Juego
йй 
=
йй 
game
йй  $
,
йй$ %
}
кк 
;
кк 
context
лл 
.
лл 
Ronda
лл !
.
лл! "
Add
лл" %
(
лл% &
round
лл& +
)
лл+ ,
;
лл, -
context
мм 
.
мм 
SaveChanges
мм '
(
мм' (
)
мм( )
;
мм) *
foreach
пп 
(
пп 
var
пп  
other
пп! &
in
пп' )
_members
пп* 2
.
пп2 3
Keys
пп3 7
)
пп7 8
{
рр 
if
сс 
(
сс 
!
сс 
_members
сс %
.
сс% &
TryGetValue
сс& 1
(
сс1 2
other
сс2 7
,
сс7 8
out
сс9 <
string
сс= C
username
ссD L
)
ссL M
)
ссM N
return
тт "
;
тт" #
var
уу 
user
уу  
=
уу! "
context
уу# *
.
уу* +
Usuario
уу+ 2
.
уу2 3
FirstOrDefault
уу3 A
(
ууA B
u
ууB C
=>
ууD F
u
ууG H
.
ууH I
Nombreusuario
ууI V
==
ууW Y
username
ууZ b
)
ууb c
;
ууc d
var
фф 
player
фф "
=
фф# $
new
фф% (
Jugador
фф) 0
{
хх 
Enturno
цц #
=
цц$ %
$num
цц& '
,
цц' (
Fichasenmano
чч (
=
чч) *
$num
чч+ ,
,
чч, -
Puntaje
шш #
=
шш$ %
$num
шш& '
,
шш' (
Usuario
щщ #
=
щщ$ %
user
щщ& *
,
щщ* +
Ronda
ъъ !
=
ъъ" #
round
ъъ$ )
,
ъъ) *
}
ыы 
;
ыы 
context
ьь 
.
ьь  
Jugador
ьь  '
.
ьь' (
Add
ьь( +
(
ьь+ ,
player
ьь, 2
)
ьь2 3
;
ьь3 4
context
ээ 
.
ээ  
SaveChanges
ээ  +
(
ээ+ ,
)
ээ, -
;
ээ- .
other
€€ 
.
€€ 

StartRound
€€ (
(
€€( )
round
€€) .
.
€€. /
RondaID
€€/ 6
)
€€6 7
;
€€7 8
}
АА 

Dictionary
ВВ 
<
ВВ 
IGameClient
ВВ *
,
ВВ* +
string
ВВ, 2
>
ВВ2 3
_membersGame
ВВ4 @
=
ВВA B
new
ВВC F

Dictionary
ВВG Q
<
ВВQ R
IGameClient
ВВR ]
,
ВВ] ^
string
ВВ_ e
>
ВВe f
(
ВВf g
)
ВВg h
;
ВВh i
_currentGames
ГГ !
.
ГГ! "
Add
ГГ" %
(
ГГ% &
round
ГГ& +
.
ГГ+ ,
RondaID
ГГ, 3
,
ГГ3 4
_membersGame
ГГ5 A
)
ГГA B
;
ГГB C
string
ЖЖ 
[
ЖЖ 
]
ЖЖ 
dominoes
ЖЖ %
=
ЖЖ& '
new
ЖЖ( +
string
ЖЖ, 2
[
ЖЖ2 3
]
ЖЖ3 4
{
ЖЖ5 6
$str
ЖЖ7 ;
,
ЖЖ; <
$str
ЖЖ= A
,
ЖЖA B
$str
ЖЖC G
,
ЖЖG H
$str
ЖЖI M
,
ЖЖM N
$str
ЖЖO S
,
ЖЖS T
$str
ЖЖU Y
,
ЖЖY Z
$str
ЖЖ[ _
,
ЖЖ_ `
$str
ЗЗ7 ;
,
ЗЗ; <
$str
ЗЗ= A
,
ЗЗA B
$str
ЗЗC G
,
ЗЗG H
$str
ЗЗI M
,
ЗЗM N
$str
ЗЗO S
,
ЗЗS T
$str
ЗЗU Y
,
ЗЗY Z
$str
ИИ7 ;
,
ИИ; <
$str
ИИ= A
,
ИИA B
$str
ИИC G
,
ИИG H
$str
ИИI M
,
ИИM N
$str
ИИO S
,
ИИS T
$str
ЙЙ7 ;
,
ЙЙ; <
$str
ЙЙ= A
,
ЙЙA B
$str
ЙЙC G
,
ЙЙG H
$str
ЙЙI M
,
ЙЙM N
$str
КК7 ;
,
КК; <
$str
КК= A
,
ККA B
$str
ККC G
,
ККG H
$str
ЛЛ7 ;
,
ЛЛ; <
$str
ЛЛ= A
,
ЛЛA B
$str
ММ7 ;
,
ММ; <
}
ММ= >
;
ММ> ?
Shuffle
НН 
(
НН 
dominoes
НН $
)
НН$ %
;
НН% &
	_dominoes
ОО 
.
ОО 
Add
ОО !
(
ОО! "
round
ОО" '
.
ОО' (
RondaID
ОО( /
,
ОО/ 0
dominoes
ОО1 9
)
ОО9 :
;
ОО: ;

Dictionary
СС 
<
СС 
IChatClient
СС *
,
СС* +
string
СС, 2
>
СС2 3
_membersRoomGame
СС4 D
=
ССE F
new
ССG J

Dictionary
ССK U
<
ССU V
IChatClient
ССV a
,
ССa b
string
ССc i
>
ССi j
(
ССj k
)
ССk l
;
ССl m
_rooms
ТТ 
.
ТТ 
Add
ТТ 
(
ТТ 
round
ТТ $
.
ТТ$ %
RondaID
ТТ% ,
,
ТТ, -
_membersRoomGame
ТТ. >
)
ТТ> ?
;
ТТ? @
_games
ХХ 
.
ХХ 
Remove
ХХ !
(
ХХ! "
gameName
ХХ" *
)
ХХ* +
;
ХХ+ ,
}
ЦЦ 
}
ЧЧ 
catch
ШШ 
(
ШШ 
	Exception
ШШ 
ex
ШШ 
)
ШШ  
{
ЩЩ 
throw
ЪЪ 
new
ЪЪ 
	Exception
ЪЪ #
(
ЪЪ# $
ex
ЪЪ$ &
.
ЪЪ& '
Message
ЪЪ' .
)
ЪЪ. /
;
ЪЪ/ 0
}
ЫЫ 
}
ЬЬ 	
readonly
ЮЮ 

Dictionary
ЮЮ 
<
ЮЮ 
int
ЮЮ 
,
ЮЮ  

Dictionary
ЮЮ! +
<
ЮЮ+ ,
IChatClient
ЮЮ, 7
,
ЮЮ7 8
string
ЮЮ9 ?
>
ЮЮ? @
>
ЮЮ@ A
_rooms
ЮЮB H
=
ЮЮI J
new
ЮЮK N

Dictionary
ЮЮO Y
<
ЮЮY Z
int
ЮЮZ ]
,
ЮЮ] ^

Dictionary
ЮЮ_ i
<
ЮЮi j
IChatClient
ЮЮj u
,
ЮЮu v
string
ЮЮw }
>
ЮЮ} ~
>
ЮЮ~ 
(ЮЮ А
)ЮЮА Б
;ЮЮБ В
public
ЯЯ 
void
ЯЯ 
JoinChat
ЯЯ 
(
ЯЯ 
int
ЯЯ  
room
ЯЯ! %
,
ЯЯ% &
string
ЯЯ' -
username
ЯЯ. 6
)
ЯЯ6 7
{
†† 	
var
°° 

connection
°° 
=
°° 
OperationContext
°° -
.
°°- .
Current
°°. 5
.
°°5 6 
GetCallbackChannel
°°6 H
<
°°H I
IChatClient
°°I T
>
°°T U
(
°°U V
)
°°V W
;
°°W X
if
ҐҐ 
(
ҐҐ 
!
ҐҐ 
_rooms
ҐҐ 
.
ҐҐ 
TryGetValue
ҐҐ #
(
ҐҐ# $
room
ҐҐ$ (
,
ҐҐ( )
out
ҐҐ* -

Dictionary
ҐҐ. 8
<
ҐҐ8 9
IChatClient
ҐҐ9 D
,
ҐҐD E
string
ҐҐF L
>
ҐҐL M
_membersRoom
ҐҐN Z
)
ҐҐZ [
)
ҐҐ[ \
{
££ 
_membersRoom
§§ 
=
§§ 
new
§§ "

Dictionary
§§# -
<
§§- .
IChatClient
§§. 9
,
§§9 :
string
§§; A
>
§§A B
(
§§B C
)
§§C D
;
§§D E
_rooms
•• 
.
•• 
Add
•• 
(
•• 
$num
•• 
,
•• 
_membersRoom
•• *
)
••* +
;
••+ ,
}
¶¶ 
(
ІІ 
(
ІІ 

Dictionary
ІІ 
<
ІІ 
IChatClient
ІІ $
,
ІІ$ %
string
ІІ& ,
>
ІІ, -
)
ІІ- .
_rooms
ІІ. 4
[
ІІ4 5
room
ІІ5 9
]
ІІ9 :
)
ІІ: ;
.
ІІ; <
Add
ІІ< ?
(
ІІ? @

connection
ІІ@ J
,
ІІJ K
username
ІІL T
)
ІІT U
;
ІІU V
}
®® 	
public
™™ 
void
™™ 
SendMessage
™™ 
(
™™  
int
™™  #
room
™™$ (
,
™™( )
string
™™* 0
message
™™1 8
)
™™8 9
{
ЂЂ 	
var
ђђ 

connection
ђђ 
=
ђђ 
OperationContext
ђђ -
.
ђђ- .
Current
ђђ. 5
.
ђђ5 6 
GetCallbackChannel
ђђ6 H
<
ђђH I
IChatClient
ђђI T
>
ђђT U
(
ђђU V
)
ђђV W
;
ђђW X
if
≠≠ 
(
≠≠ 
!
≠≠ 
_rooms
≠≠ 
.
≠≠ 
TryGetValue
≠≠ #
(
≠≠# $
room
≠≠$ (
,
≠≠( )
out
≠≠* -

Dictionary
≠≠. 8
<
≠≠8 9
IChatClient
≠≠9 D
,
≠≠D E
string
≠≠F L
>
≠≠L M
_membersRoom
≠≠N Z
)
≠≠Z [
)
≠≠[ \
return
ЃЃ 
;
ЃЃ 
if
ѓѓ 
(
ѓѓ 
!
ѓѓ 
_membersRoom
ѓѓ 
.
ѓѓ 
TryGetValue
ѓѓ )
(
ѓѓ) *

connection
ѓѓ* 4
,
ѓѓ4 5
out
ѓѓ6 9
string
ѓѓ: @
user
ѓѓA E
)
ѓѓE F
)
ѓѓF G
return
∞∞ 
;
∞∞ 
foreach
≤≤ 
(
≤≤ 
var
≤≤ 
other
≤≤ 
in
≤≤ !
_membersRoom
≤≤" .
.
≤≤. /
Keys
≤≤/ 3
)
≤≤3 4
{
≥≥ 
if
іі 
(
іі 
other
іі 
==
іі 

connection
іі '
)
іі' (
continue
µµ 
;
µµ 
other
ґґ 
.
ґґ 
ReciveMessage
ґґ #
(
ґґ# $
user
ґґ$ (
,
ґґ( )
message
ґґ* 1
)
ґґ1 2
;
ґґ2 3
}
ЈЈ 
}
ЄЄ 	
public
ЇЇ 
bool
ЇЇ 
ChangePassword
ЇЇ "
(
ЇЇ" #
string
ЇЇ# )
username
ЇЇ* 2
,
ЇЇ2 3
string
ЇЇ4 :
currentPassword
ЇЇ; J
,
ЇЇJ K
string
ЇЇL R
newPassword
ЇЇS ^
)
ЇЇ^ _
{
її 	
try
ЉЉ 
{
љљ 
using
ЊЊ 
(
ЊЊ 
DominoContext
ЊЊ $
context
ЊЊ% ,
=
ЊЊ- .
new
ЊЊ/ 2
DominoContext
ЊЊ3 @
(
ЊЊ@ A
)
ЊЊA B
)
ЊЊB C
{
њњ 
var
јј 
user
јј 
=
јј 
context
јј &
.
јј& '
Usuario
јј' .
.
јј. /
FirstOrDefault
јј/ =
(
јј= >
u
јј> ?
=>
јј@ B
u
јјC D
.
јјD E
Nombreusuario
јјE R
==
јјS U
username
јјV ^
)
јј^ _
;
јј_ `
if
ЅЅ 
(
ЅЅ 
user
ЅЅ 
!=
ЅЅ 
null
ЅЅ  $
)
ЅЅ$ %
{
¬¬ 
if
√√ 
(
√√ 
user
√√  
.
√√  !
Contrase√±a
√√! +
.
√√+ ,
Equals
√√, 2
(
√√2 3
currentPassword
√√3 B
)
√√B C
)
√√C D
{
ƒƒ 
user
≈≈  
.
≈≈  !
Contrase√±a
≈≈! +
=
≈≈, -
newPassword
≈≈. 9
;
≈≈9 :
context
∆∆ #
.
∆∆# $
SaveChanges
∆∆$ /
(
∆∆/ 0
)
∆∆0 1
;
∆∆1 2
return
«« "
true
««# '
;
««' (
}
»» 
}
…… 
}
   
}
ЋЋ 
catch
ћћ 
{
ЌЌ 
}
ѕѕ 
return
–– 
false
–– 
;
–– 
}
—— 	
public
”” "
ObservableCollection
”” #
<
””# $
UsuarioPuntajes
””$ 3
>
””3 4
	GetScores
””5 >
(
””> ?
)
””? @
{
‘‘ 	"
ObservableCollection
’’  
<
’’  !
UsuarioPuntajes
’’! 0
>
’’0 1
scores
’’2 8
=
’’9 :
new
’’; >"
ObservableCollection
’’? S
<
’’S T
UsuarioPuntajes
’’T c
>
’’c d
(
’’d e
)
’’e f
;
’’f g
try
÷÷ 
{
„„ 
using
ЎЎ 
(
ЎЎ 
DominoContext
ЎЎ $
context
ЎЎ% ,
=
ЎЎ- .
new
ЎЎ/ 2
DominoContext
ЎЎ3 @
(
ЎЎ@ A
)
ЎЎA B
)
ЎЎB C
{
ўў 
var
ЏЏ 
usersByScore
ЏЏ $
=
ЏЏ% &
context
ЏЏ' .
.
ЏЏ. /
Usuario
ЏЏ/ 6
.
ЏЏ6 7
OrderByDescending
ЏЏ7 H
(
ЏЏH I
p
ЏЏI J
=>
ЏЏK M
p
ЏЏN O
.
ЏЏO P
Puntajeacumulado
ЏЏP `
)
ЏЏ` a
;
ЏЏa b
int
џџ 
lugar
џџ 
=
џџ 
$num
џџ  !
;
џџ! "
foreach
№№ 
(
№№ 
Usuario
№№ $
user
№№% )
in
№№* ,
usersByScore
№№- 9
)
№№9 :
{
ЁЁ 
if
ёё 
(
ёё 
user
ёё  
!=
ёё! #
null
ёё$ (
)
ёё( )
{
яя 
scores
аа "
.
аа" #
Add
аа# &
(
аа& '
new
аа' *
UsuarioPuntajes
аа+ :
(
аа: ;
lugar
аа; @
,
аа@ A
user
ааB F
.
ааF G
Nombreusuario
ааG T
,
ааT U
(
ааV W
int
ааW Z
)
ааZ [
user
аа[ _
.
аа_ `
Puntajeacumulado
аа` p
)
ааp q
)
ааq r
;
ааr s
}
бб 
else
вв 
return
гг "
scores
гг# )
;
гг) *
lugar
дд 
++
дд 
;
дд  
if
жж 
(
жж 
lugar
жж !
==
жж" $
$num
жж% &
)
жж& '
return
зз "
scores
зз# )
;
зз) *
}
ии 
}
йй 
}
кк 
catch
лл 
(
лл 
	Exception
лл 
ex
лл 
)
лл  
{
мм 
throw
нн 
new
нн 
	Exception
нн #
(
нн# $
ex
нн$ &
.
нн& '
Message
нн' .
)
нн. /
;
нн/ 0
}
оо 
return
пп 
scores
пп 
;
пп 
}
рр 	
public
тт 
bool
тт 
RecoverPassword
тт #
(
тт# $
string
тт$ *
email
тт+ 0
)
тт0 1
{
уу 	
try
фф 
{
хх 
using
цц 
(
цц 
DominoContext
цц $
context
цц% ,
=
цц- .
new
цц/ 2
DominoContext
цц3 @
(
цц@ A
)
ццA B
)
ццB C
{
чч 
var
шш 
user
шш 
=
шш 
context
шш &
.
шш& '
Usuario
шш' .
.
шш. /
FirstOrDefault
шш/ =
(
шш= >
u
шш> ?
=>
шш@ B
u
шшC D
.
шшD E
Correo
шшE K
==
шшL N
email
шшO T
)
шшT U
;
шшU V
if
щщ 
(
щщ 
user
щщ 
!=
щщ 
null
щщ  $
)
щщ$ %
{
ъъ 
	SendEmail
ыы !
(
ыы! "
user
ыы" &
,
ыы& '
false
ыы( -
)
ыы- .
;
ыы. /
return
ьь 
true
ьь #
;
ьь# $
}
ээ 
else
юю 
return
€€ 
false
€€ $
;
€€$ %
}
АА 
}
ББ 
catch
ВВ 
(
ВВ 
	Exception
ВВ 
ex
ВВ 
)
ВВ  
{
ГГ 
throw
ДД 
new
ДД 
	Exception
ДД #
(
ДД# $
ex
ДД$ &
.
ДД& '
Message
ДД' .
)
ДД. /
;
ДД/ 0
}
ЕЕ 
}
ЖЖ 	
[
ИИ 	
Obsolete
ИИ	 
]
ИИ 
public
ЙЙ 
bool
ЙЙ 
SignUp
ЙЙ 
(
ЙЙ 
string
ЙЙ !
username
ЙЙ" *
,
ЙЙ* +
string
ЙЙ, 2
email
ЙЙ3 8
,
ЙЙ8 9
string
ЙЙ: @
password
ЙЙA I
)
ЙЙI J
{
КК 	
try
ЛЛ 
{
ММ 
using
НН 
(
НН 
DominoContext
НН $
context
НН% ,
=
НН- .
new
НН/ 2
DominoContext
НН3 @
(
НН@ A
)
ННA B
)
ННB C
{
ОО 
var
ПП 
existingUser
ПП $
=
ПП% &
context
ПП' .
.
ПП. /
Usuario
ПП/ 6
.
ПП6 7
FirstOrDefault
ПП7 E
(
ППE F
u
ППF G
=>
ППH J
u
ППK L
.
ППL M
Correo
ППM S
==
ППT V
email
ППW \
)
ПП\ ]
;
ПП] ^
if
РР 
(
РР 
existingUser
РР $
==
РР% '
null
РР( ,
)
РР, -
{
СС 
existingUser
ТТ $
=
ТТ% &
context
ТТ' .
.
ТТ. /
Usuario
ТТ/ 6
.
ТТ6 7
FirstOrDefault
ТТ7 E
(
ТТE F
u
ТТF G
=>
ТТH J
u
ТТK L
.
ТТL M
Nombreusuario
ТТM Z
==
ТТ[ ]
username
ТТ^ f
)
ТТf g
;
ТТg h
if
УУ 
(
УУ 
existingUser
УУ (
==
УУ) +
null
УУ, 0
)
УУ0 1
{
ФФ 
var
ХХ 
user
ХХ  $
=
ХХ% &
new
ХХ' *
Usuario
ХХ+ 2
{
ЦЦ 
Nombreusuario
ЧЧ  -
=
ЧЧ. /
username
ЧЧ0 8
,
ЧЧ8 9
Correo
ШШ  &
=
ШШ' (
email
ШШ) .
,
ШШ. /
Contrase√±a
ЩЩ  *
=
ЩЩ+ ,
password
ЩЩ- 5
,
ЩЩ5 6
Puntajeacumulado
ЪЪ  0
=
ЪЪ1 2
$num
ЪЪ3 4
,
ЪЪ4 5
Estatus
ЫЫ  '
=
ЫЫ( )
$num
ЫЫ* +
,
ЫЫ+ ,
Token
ЬЬ  %
=
ЬЬ& '
ShortId
ЬЬ( /
.
ЬЬ/ 0
Generate
ЬЬ0 8
(
ЬЬ8 9
)
ЬЬ9 :
.
ЬЬ: ;
Trim
ЬЬ; ?
(
ЬЬ? @
)
ЬЬ@ A
}
ЭЭ 
;
ЭЭ 
context
ЮЮ #
.
ЮЮ# $
Usuario
ЮЮ$ +
.
ЮЮ+ ,
Add
ЮЮ, /
(
ЮЮ/ 0
user
ЮЮ0 4
)
ЮЮ4 5
;
ЮЮ5 6
context
ЯЯ #
.
ЯЯ# $
SaveChanges
ЯЯ$ /
(
ЯЯ/ 0
)
ЯЯ0 1
;
ЯЯ1 2
	SendEmail
°° %
(
°°% &
user
°°& *
,
°°* +
true
°°, 0
)
°°0 1
;
°°1 2
Console
££ #
.
££# $
	WriteLine
££$ -
(
££- .
$str
££. 9
+
££: ;
username
££< D
+
££E F
$str
££G t
+
££u v
email
££w |
)
££| }
;
££} ~
return
§§ "
true
§§# '
;
§§' (
}
•• 
}
¶¶ 
}
ІІ 
}
®® 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
™™ 
throw
ЂЂ 
new
ЂЂ 
	Exception
ЂЂ #
(
ЂЂ# $
ex
ЂЂ$ &
.
ЂЂ& '
Message
ЂЂ' .
)
ЂЂ. /
;
ЂЂ/ 0
}
ђђ 
return
≠≠ 
false
≠≠ 
;
≠≠ 
}
ЃЃ 	
public
∞∞ 
bool
∞∞ 
VerificateUser
∞∞ "
(
∞∞" #
string
∞∞# )
username
∞∞* 2
,
∞∞2 3
string
∞∞4 :
token
∞∞; @
)
∞∞@ A
{
±± 	
try
≤≤ 
{
≥≥ 
using
іі 
(
іі 
DominoContext
іі $
context
іі% ,
=
іі- .
new
іі/ 2
DominoContext
іі3 @
(
іі@ A
)
ііA B
)
ііB C
{
µµ 
var
ґґ 
user
ґґ 
=
ґґ 
context
ґґ &
.
ґґ& '
Usuario
ґґ' .
.
ґґ. /
FirstOrDefault
ґґ/ =
(
ґґ= >
u
ґґ> ?
=>
ґґ@ B
u
ґґC D
.
ґґD E
Nombreusuario
ґґE R
==
ґґS U
username
ґґV ^
)
ґґ^ _
;
ґґ_ `
if
ЈЈ 
(
ЈЈ 
user
ЈЈ 
!=
ЈЈ 
null
ЈЈ  $
)
ЈЈ$ %
{
ЄЄ 
if
єє 
(
єє 
!
єє 

IsVerified
єє '
(
єє' (
user
єє( ,
.
єє, -
Nombreusuario
єє- :
)
єє: ;
)
єє; <
{
ЇЇ 
if
її 
(
її  
user
її  $
.
її$ %
Token
її% *
==
її+ -
token
її. 3
)
її3 4
{
ЉЉ 
user
љљ  $
.
љљ$ %
Estatus
љљ% ,
=
љљ- .
$num
љљ/ 0
;
љљ0 1
context
ЊЊ  '
.
ЊЊ' (
SaveChanges
ЊЊ( 3
(
ЊЊ3 4
)
ЊЊ4 5
;
ЊЊ5 6
return
њњ  &
true
њњ' +
;
њњ+ ,
}
јј 
else
ЅЅ  
return
¬¬  &
false
¬¬' ,
;
¬¬, -
}
√√ 
else
ƒƒ 
return
≈≈ "
true
≈≈# '
;
≈≈' (
}
∆∆ 
}
«« 
}
»» 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
   
throw
ЋЋ 
new
ЋЋ 
	Exception
ЋЋ #
(
ЋЋ# $
ex
ЋЋ$ &
.
ЋЋ& '
Message
ЋЋ' .
)
ЋЋ. /
;
ЋЋ/ 0
}
ћћ 
return
ЌЌ 
false
ЌЌ 
;
ЌЌ 
}
ќќ 	
public
–– 
bool
–– 

IsVerified
–– 
(
–– 
string
–– %
username
––& .
)
––. /
{
—— 	
try
““ 
{
”” 
using
‘‘ 
(
‘‘ 
DominoContext
‘‘ $
context
‘‘% ,
=
‘‘- .
new
‘‘/ 2
DominoContext
‘‘3 @
(
‘‘@ A
)
‘‘A B
)
‘‘B C
{
’’ 
var
÷÷ 
user
÷÷ 
=
÷÷ 
context
÷÷ &
.
÷÷& '
Usuario
÷÷' .
.
÷÷. /
FirstOrDefault
÷÷/ =
(
÷÷= >
u
÷÷> ?
=>
÷÷@ B
u
÷÷C D
.
÷÷D E
Nombreusuario
÷÷E R
==
÷÷S U
username
÷÷V ^
)
÷÷^ _
;
÷÷_ `
if
„„ 
(
„„ 
user
„„ 
!=
„„ 
null
„„  $
)
„„$ %
{
ЎЎ 
if
ўў 
(
ўў 
user
ўў  
.
ўў  !
Estatus
ўў! (
==
ўў) +
$num
ўў, -
)
ўў- .
return
ЏЏ "
true
ЏЏ# '
;
ЏЏ' (
else
џџ 
return
№№ "
false
№№# (
;
№№( )
}
ЁЁ 
}
ёё 
}
яя 
catch
аа 
(
аа 
	Exception
аа 
ex
аа 
)
аа  
{
бб 
throw
вв 
new
вв 
	Exception
вв #
(
вв# $
ex
вв$ &
.
вв& '
Message
вв' .
)
вв. /
;
вв/ 0
}
гг 
return
дд 
false
дд 
;
дд 
}
ее 	
public
зз 
string
зз 
LogIn
зз 
(
зз 
string
зз "
email
зз# (
,
зз( )
string
зз* 0
password
зз1 9
)
зз9 :
{
ии 	
try
йй 
{
кк 
using
лл 
(
лл 
DominoContext
лл $
context
лл% ,
=
лл- .
new
лл/ 2
DominoContext
лл3 @
(
лл@ A
)
ллA B
)
ллB C
{
мм 
var
нн 
user
нн 
=
нн 
context
нн &
.
нн& '
Usuario
нн' .
.
нн. /
FirstOrDefault
нн/ =
(
нн= >
u
нн> ?
=>
нн@ B
u
ннC D
.
ннD E
Correo
ннE K
==
ннL N
email
ннO T
)
ннT U
;
ннU V
if
оо 
(
оо 
user
оо 
!=
оо 
null
оо  $
)
оо$ %
{
пп 
if
рр 
(
рр 
user
рр  
.
рр  !
Contrase√±a
рр! +
==
рр, .
password
рр/ 7
)
рр7 8
{
сс 
Console
тт #
.
тт# $
	WriteLine
тт$ -
(
тт- .
$str
тт. 9
+
тт: ;
user
тт< @
.
тт@ A
Nombreusuario
ттA N
+
ттO P
$str
ттQ f
)
ттf g
;
ттg h
return
уу "
user
уу# '
.
уу' (
Nombreusuario
уу( 5
;
уу5 6
}
фф 
}
хх 
return
цц 
(
цц 
$str
цц 
)
цц 
;
цц  
}
чч 
}
шш 
catch
щщ 
(
щщ 
	Exception
щщ 
ex
щщ 
)
щщ  
{
ъъ 
throw
ыы 
new
ыы 
	Exception
ыы #
(
ыы# $
ex
ыы$ &
.
ыы& '
Message
ыы' .
)
ыы. /
;
ыы/ 0
}
ьь 
}
ээ 	
private
€€ 
bool
€€ 
	SendEmail
€€ 
(
€€ 
Usuario
€€ &
user
€€' +
,
€€+ ,
bool
€€- 1
isSignUp
€€2 :
)
€€: ;
{
АА 	
try
ББ 
{
ВВ 
MailMessage
ГГ 
mail
ГГ  
=
ГГ! "
new
ГГ# &
MailMessage
ГГ' 2
(
ГГ2 3
)
ГГ3 4
;
ГГ4 5

SmtpClient
ДД 

SmtpServer
ДД %
=
ДД& '
new
ДД( +

SmtpClient
ДД, 6
(
ДД6 7
$str
ДД7 G
)
ДДG H
;
ДДH I
mail
ЖЖ 
.
ЖЖ 
From
ЖЖ 
=
ЖЖ 
new
ЖЖ 
MailAddress
ЖЖ  +
(
ЖЖ+ ,
$str
ЖЖ, G
,
ЖЖG H
$str
ЖЖI W
,
ЖЖW X
System
ЖЖY _
.
ЖЖ_ `
Text
ЖЖ` d
.
ЖЖd e
Encoding
ЖЖe m
.
ЖЖm n
UTF8
ЖЖn r
)
ЖЖr s
;
ЖЖs t
mail
ЗЗ 
.
ЗЗ 
To
ЗЗ 
.
ЗЗ 
Add
ЗЗ 
(
ЗЗ 
user
ЗЗ  
.
ЗЗ  !
Correo
ЗЗ! '
)
ЗЗ' (
;
ЗЗ( )
if
ИИ 
(
ИИ 
isSignUp
ИИ 
)
ИИ 
{
ЙЙ 
mail
КК 
.
КК 
Subject
КК  
=
КК! "
$str
КК# C
;
ККC D
mail
ЛЛ 
.
ЛЛ 
Body
ЛЛ 
=
ЛЛ 
$str
ЛЛ  (
+
ЛЛ) *
user
ЛЛ+ /
.
ЛЛ/ 0
Nombreusuario
ЛЛ0 =
+
ЛЛ> ?
$str
ЛЛ@ z
+
ЛЛ{ |
user
ММ 
.
ММ 
Token
ММ "
;
ММ" #
}
НН 
else
ОО 
{
ПП 
mail
РР 
.
РР 
Subject
РР  
=
РР! "
$str
РР# G
;
РРG H
mail
СС 
.
СС 
Body
СС 
=
СС 
$str
СС  (
+
СС) *
user
СС+ /
.
СС/ 0
Nombreusuario
СС0 =
+
СС> ?
$strСС@ А
+ССБ В
user
ТТ 
.
ТТ 
Contrase√±a
ТТ '
+
ТТ( )
$str
ТТ* k
;
ТТk l
}
УУ 

SmtpServer
ФФ 
.
ФФ 
Port
ФФ 
=
ФФ  !
$num
ФФ" %
;
ФФ% &

SmtpServer
ХХ 
.
ХХ 
Credentials
ХХ &
=
ХХ' (
new
ХХ) ,
System
ХХ- 3
.
ХХ3 4
Net
ХХ4 7
.
ХХ7 8
NetworkCredential
ХХ8 I
(
ХХI J
$str
ХХJ e
,
ХХe f
$str
ХХg v
)
ХХv w
;
ХХw x

SmtpServer
ЦЦ 
.
ЦЦ 
	EnableSsl
ЦЦ $
=
ЦЦ% &
true
ЦЦ' +
;
ЦЦ+ ,

SmtpServer
ЧЧ 
.
ЧЧ 
Send
ЧЧ 
(
ЧЧ  
mail
ЧЧ  $
)
ЧЧ$ %
;
ЧЧ% &
return
ШШ 
true
ШШ 
;
ШШ 
}
ЪЪ 
catch
ЫЫ 
(
ЫЫ 
	Exception
ЫЫ 
ex
ЫЫ 
)
ЫЫ  
{
ЬЬ 
throw
ЭЭ 
new
ЭЭ 
	Exception
ЭЭ #
(
ЭЭ# $
ex
ЭЭ$ &
.
ЭЭ& '
Message
ЭЭ' .
)
ЭЭ. /
;
ЭЭ/ 0
}
ЮЮ 
}
ЯЯ 	
public
°° 
static
°° 
void
°° 
Shuffle
°° "
<
°°" #
T
°°# $
>
°°$ %
(
°°% &
IList
°°& +
<
°°+ ,
T
°°, -
>
°°- .
values
°°/ 5
)
°°5 6
{
ҐҐ 	
var
££ 
n
££ 
=
££ 
values
££ 
.
££ 
Count
££  
;
££  !
var
§§ 
rnd
§§ 
=
§§ 
new
§§ 
Random
§§  
(
§§  !
)
§§! "
;
§§" #
for
•• 
(
•• 
int
•• 
i
•• 
=
•• 
n
•• 
-
•• 
$num
•• 
;
•• 
i
••  !
>
••" #
$num
••$ %
;
••% &
i
••' (
--
••( *
)
••* +
{
¶¶ 
var
ІІ 
j
ІІ 
=
ІІ 
rnd
ІІ 
.
ІІ 
Next
ІІ  
(
ІІ  !
$num
ІІ! "
,
ІІ" #
i
ІІ$ %
)
ІІ% &
;
ІІ& '
var
®® 
temp
®® 
=
®® 
values
®® !
[
®®! "
i
®®" #
]
®®# $
;
®®$ %
values
©© 
[
©© 
i
©© 
]
©© 
=
©© 
values
©© "
[
©©" #
j
©©# $
]
©©$ %
;
©©% &
values
™™ 
[
™™ 
j
™™ 
]
™™ 
=
™™ 
temp
™™  
;
™™  !
}
ЂЂ 
}
ђђ 	
}
≠≠ 
}ЃЃ √
>C:\Users\ricar\Documents\GitHub\domino\DominoServer\Program.cs
	namespace 	
DominoServer
 
{ 
class 	
Program
 
{ 
static 
void 
Main 
( 
) 
{		 	
ServiceHost

 
host

 
=

 
new

 "
ServiceHost

# .
(

. /
typeof

/ 5
(

5 6
DominoService

6 C
)

C D
)

D E
;

E F
host 
. 
Open 
( 
) 
; 
Console 
. 
	WriteLine 
( 
$str 9
)9 :
;: ;
Console 
. 
ReadLine 
( 
) 
; 
host 
. 
Close 
( 
) 
; 
} 	
} 
} 